CREATE TABLE IF NOT EXISTS funcionario(
	 id INTEGER PRIMARY KEY AUTOINCREMENT,
     nome VARCHAR(100) not NULL,
     cpf VARCHAR(14) NOT NULL UNIQUE,
     telefone VARCHAR(15),
     email VARCHAR(100),
     data_nascimento DATE,
     endereco TEXT
);
CREATE TABLE IF NOT EXISTS cliente(
	id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome VARCHAR(100) NOT NULL,
    cpf VARCHAR(14) NOT NULL UNIQUE,
    telefone VARCHAR(15),
    data_nascimento DATE,
    endereco TEXT
	
);

CREATE TABLE IF NOT EXISTS categoria(
	id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    descricao TEXT
);

CREATE TABLE IF NOT EXISTS produto(
	id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    descricao TEXT,
    codigo_barras TEXT UNIQUE,
    preco_custo REAL NOT NULL,
    preco_venda REAL NOT NULL,
    quantidade_estoque INTEGER DEFAULT 0,
    categoria_id INTEGER,
    fornecedor_id INTEGER,
    data_validade DATE,
    unidade_medida TEXT,
    FOREIGN KEY (categoria_id) REFERENCES categorias(id),
    FOREIGN KEY (fornecedor_id) REFERENCES fornecedores(id)
);

CREATE TABLE IF NOT EXISTS fornecedor(
	id INTEGER PRIMARY KEY AUTOINCREMENT,
    nome TEXT NOT NULL,
    cnpj TEXT UNIQUE,
    telefone TEXT,
    email TEXT,
    endereco TEXT
);

CREATE TABLE IF NOT EXISTS vendas(
	id INTEGER PRIMARY KEY AUTOINCREMENT,
    data_hora DATETIME DEFAULT CURRENT_TIMESTAMP,
    cliente_id INTEGER,
    funcionario_id INTEGER,
    total REAL NOT NULL,
    forma_pagamento TEXT,
    status TEXT DEFAULT 'finalizada',
    FOREIGN KEY (cliente_id) REFERENCES clientes(id),
    FOREIGN KEY (funcionario_id) REFERENCES funcionarios(id)
);

CREATE TABLE notas_fiscais (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    numero INTEGER NOT NULL,
    serie TEXT NOT NULL DEFAULT '1',
    chave_acesso TEXT UNIQUE,
    venda_id INTEGER NOT NULL,
    data_emissao DATETIME DEFAULT CURRENT_TIMESTAMP,
    data_saida DATETIME,
    tipo_operacao INTEGER DEFAULT 1, -- 1=sa√≠da, 2=entrada
    status TEXT DEFAULT 'EMITIDA', -- EMITIDA, CANCELADA, CONTINGENCIA
    natureza_operacao TEXT DEFAULT 'VENDA',
    codigo_nfe TEXT,
    xml TEXT,
    pdf BLOB,
    FOREIGN KEY (venda_id) REFERENCES vendas(id)
);
